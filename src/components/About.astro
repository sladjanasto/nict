---
import { getUITranslations, getLangFromUrl, getPageContent } from '../utils/i18n.ts';

const { url } = Astro;
const lang = getLangFromUrl(url);
const ui = await getUITranslations(lang);
const aboutContent = await getPageContent(lang, 'about');

// Fallback content if markdown content is not available
const content = aboutContent ? await aboutContent.render() : null;

// Extract data to avoid complex expressions in template
const aboutData = ui.about;
const coreCompetencies = aboutData.coreCompetencies?.items || [];
const certifications = aboutData.certifications?.items || [];
const advantages = aboutData.advantages || [];
---

<section id="about" class="about section">
	<div class="container">
		<h2 class="section-title">{ui.about.title}</h2>
		
		{aboutContent && (
			<div class="about-markdown">
				<Fragment set:html={content?.Content} />
			</div>
		)}
		
		<div class="about-content">
			<div class="about-intro">
				<h3 class="about-subtitle">{ui.about.subtitle}</h3>
				<p class="about-description">
					{ui.about.description}
				</p>
			</div>
			
			<div class="what-sets-apart">
				<h4>{ui.about.whatSetsApart}</h4>
				<div class="advantages-grid">
					{advantages.map((advantage: any) => (
						<div class="advantage-item">
							<div class="advantage-icon">{advantage.icon}</div>
							<h5>{advantage.title}</h5>
							<p>{advantage.description}</p>
						</div>
					))}
				</div>
			</div>
			
			<div class="philosophy">
				<p class="philosophy-text">
					{ui.about.philosophy}
				</p>
			</div>
		</div>
		
		<div class="core-competencies">
			<h3 class="competencies-title">{ui.about.coreCompetencies.title}</h3>
			<div class="competencies-grid">
				{coreCompetencies.map((competency: any) => (
					<div class="competency-card">
						<h4>{competency.title}</h4>
						<ul class="competency-list">
							{competency.skills.map((skill: string) => (
								<li>{skill}</li>
							))}
						</ul>
					</div>
				))}
			</div>
		</div>
		
		<div class="certifications">
			<h3 class="certifications-title">{ui.about.certifications.title}</h3>
			<div class="cert-grid">
				{certifications.map((cert: any) => (
					<div class="cert-item">
						<div class="cert-year">{cert.year}</div>
						<div class="cert-details">
							<h5>{cert.title}</h5>
							<p>{cert.issuer}</p>
						</div>
					</div>
				))}
			</div>
			<p class="continuing-education">
				{ui.about.certifications.continuingEducation}
			</p>
		</div>
	</div>
</section>

<style>
	.about {
		background: var(--bg-primary);
		padding: var(--spacing-xxl) 0;
	}
	
	.about-markdown {
		margin-bottom: 40px;
		text-align: center;
	}
	
	.about-markdown :global(h2),
	.about-markdown :global(h3) {
		color: var(--text-primary);
		margin-bottom: 16px;
	}
	
	.about-markdown :global(p) {
		color: var(--text-light);
		line-height: 1.6;
		margin-bottom: 16px;
	}
	
	.about-content {
		max-width: 1000px;
		margin: 0 auto var(--spacing-xxl);
	}
	
	.about-intro {
		text-align: center;
		margin-bottom: var(--spacing-xxl);
	}
	
	.about-subtitle {
		font-family: var(--font-headings);
		font-size: var(--font-size-2xl);
		color: var(--primary-color);
		margin-bottom: var(--spacing-lg);
		font-weight: 600;
	}
	
	.about-description {
		font-size: var(--font-size-lg);
		color: var(--text-light);
		line-height: 1.7;
		max-width: 800px;
		margin: 0 auto;
	}
	
	.what-sets-apart {
		margin-bottom: var(--spacing-xxl);
	}
	
	.what-sets-apart h4 {
		font-family: var(--font-headings);
		font-size: var(--font-size-xl);
		color: var(--text-dark);
		margin-bottom: var(--spacing-xl);
		text-align: center;
	}
	
	.advantages-grid {
		display: grid;
		grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
		gap: var(--spacing-xl);
		margin-bottom: var(--spacing-xl);
	}
	
	.advantage-item {
		text-align: center;
		padding: var(--spacing-lg);
		background: var(--bg-secondary);
		border-radius: var(--radius-lg);
		transition: transform var(--transition-normal), box-shadow var(--transition-normal);
	}
	
	.advantage-item:hover {
		transform: translateY(-5px);
		box-shadow: var(--shadow-lg);
	}
	
	.advantage-icon {
		font-size: 3rem;
		margin-bottom: var(--spacing-md);
	}
	
	.advantage-item h5 {
		font-family: var(--font-headings);
		font-size: var(--font-size-lg);
		color: var(--text-dark);
		margin-bottom: var(--spacing-sm);
		font-weight: 600;
	}
	
	.advantage-item p {
		color: var(--text-light);
		line-height: 1.5;
	}
	
	.philosophy {
		text-align: center;
		padding: var(--spacing-xl);
		background: var(--bg-gradient);
		border-radius: var(--radius-lg);
		margin-top: var(--spacing-xl);
	}
	
	.philosophy-text {
		font-size: var(--font-size-lg);
		color: var(--text-white);
		font-style: italic;
		line-height: 1.6;
		margin: 0;
		font-weight: 500;
	}
	
	.core-competencies {
		margin-bottom: var(--spacing-xxl);
	}
	
	.competencies-title {
		font-family: var(--font-headings);
		font-size: var(--font-size-3xl);
		color: var(--text-dark);
		text-align: center;
		margin-bottom: var(--spacing-xxl);
		font-weight: 700;
	}
	
	.competencies-grid {
		display: grid;
		grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
		gap: var(--spacing-xl);
	}
	
	.competency-card {
		background: var(--bg-secondary);
		padding: var(--spacing-xl);
		border-radius: var(--radius-lg);
		box-shadow: var(--shadow-md);
		transition: transform var(--transition-normal), box-shadow var(--transition-normal);
	}
	
	.competency-card:hover {
		transform: translateY(-5px);
		box-shadow: var(--shadow-lg);
	}
	
	
	.competency-card h4 {
		font-family: var(--font-headings);
		font-size: var(--font-size-lg);
		color: var(--text-dark);
		margin-bottom: var(--spacing-lg);
		font-weight: 600;
	}
	
	.competency-list {
		list-style: none;
		padding: 0;
		margin: 0;
	}
	
	.competency-list li {
		position: relative;
		padding-left: var(--spacing-lg);
		margin-bottom: var(--spacing-sm);
		color: var(--text-light);
		line-height: 1.5;
	}
	
	.competency-list li::before {
		content: "âœ“";
		position: absolute;
		left: 0;
		color: var(--primary-color);
		font-weight: bold;
	}
	
	.certifications {
		background: var(--bg-secondary);
		padding: var(--spacing-xxl);
		border-radius: var(--radius-lg);
	}
	
	.certifications-title {
		font-family: var(--font-headings);
		font-size: var(--font-size-2xl);
		color: var(--text-dark);
		text-align: center;
		margin-bottom: var(--spacing-xl);
		font-weight: 600;
	}
	
	.cert-grid {
		display: grid;
		grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
		gap: var(--spacing-lg);
		margin-bottom: var(--spacing-xl);
	}
	
	.cert-item {
		display: flex;
		align-items: center;
		gap: var(--spacing-lg);
		padding: var(--spacing-lg);
		background: var(--bg-primary);
		border-radius: var(--radius-md);
		box-shadow: var(--shadow-sm);
	}
	
	.cert-year {
		font-family: var(--font-headings);
		font-size: var(--font-size-xl);
		font-weight: 700;
		color: var(--primary-color);
		min-width: 60px;
	}
	
	.cert-details h5 {
		font-family: var(--font-headings);
		font-size: var(--font-size-base);
		color: var(--text-dark);
		margin: 0 0 var(--spacing-xs) 0;
		font-weight: 600;
	}
	
	.cert-details p {
		color: var(--text-light);
		margin: 0;
		font-size: var(--font-size-sm);
	}
	
	.continuing-education {
		text-align: center;
		color: var(--text-light);
		font-style: italic;
		margin: 0;
	}
	
	@media (max-width: 768px) {
		.advantages-grid {
			grid-template-columns: 1fr;
		}
		
		.competencies-grid {
			grid-template-columns: 1fr;
		}
		
		.cert-grid {
			grid-template-columns: 1fr;
		}
		
		.about-subtitle {
			font-size: var(--font-size-xl);
		}
		
		.competencies-title {
			font-size: var(--font-size-2xl);
		}
	}
</style>