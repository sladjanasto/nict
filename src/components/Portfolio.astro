---
import { getUITranslations, getLangFromUrl, getPageContent } from '../utils/i18n.ts';

const { url } = Astro;
const lang = getLangFromUrl(url);
const ui = await getUITranslations(lang);
const portfolioContent = await getPageContent(lang, 'portfolio');

// Fallback content if markdown content is not available
const content = portfolioContent ? await portfolioContent.render() : null;

// Extract data to avoid complex expressions in template
const portfolioData = ui.portfolio || {};
const projects = portfolioData.projects || [];
const techCategories = portfolioData.technologyExpertise?.categories || [];
const techExpertiseData = portfolioData.technologyExpertise || {};
---

<section id="portfolio" class="portfolio section">
	<div class="container">
		<h2 class="section-title">{portfolioData.title || 'Featured Projects'}</h2>
		<p class="portfolio-intro">
			{portfolioData.subtitle || 'Real-world solutions and measurable results from successful IT transformations'}
		</p>
		
		{portfolioContent && (
			<div class="portfolio-markdown">
				<Fragment set:html={content?.Content} />
			</div>
		)}
		
		<div class="projects-grid">
			{projects.map((project: any, index: number) => (
				<div class={`project-card ${index === 0 ? 'featured' : ''}`}>
					<div class="project-header">
						<div class="project-meta">
							<h3 class="project-main-title">{project.title}</h3>
							{project.subtitle && <h4 class="project-subtitle">{project.subtitle}</h4>}
							<div class="project-details">
								<span class="industry">{project.industry}</span>
								<span class="position">{project.position}</span>
								<span class="duration">{project.duration}</span>
							</div>
						</div>
					</div>
					<div class="project-content">
						<div class="challenge">
							<h4>{portfolioData.challenge || 'Challenge'}:</h4>
							<p>{project.challenge}</p>
						</div>
						<div class="results">
							<h4>{portfolioData.results || 'Results'}:</h4>
							<ul class="results-list">
								{(project.results || []).map((result: string) => (
									<li>{result}</li>
								))}
							</ul>
						</div>
					</div>
				</div>
			))}
		</div>
		
		<div class="technology-expertise">
			<h3>{techExpertiseData.title || 'Technology Expertise'}</h3>
			<div class="tech-categories">
				{techCategories.map((category: any) => (
					<div class="tech-category">
						<h4>{category.title}</h4>
						<div class="tech-tags">
							{(category.technologies || []).map((tech: string) => (
								<span class="tech-tag">{tech}</span>
							))}
						</div>
					</div>
				))}
			</div>
		</div>
	</div>
</section>
				<div class="project-header">
					<div class="project-meta">
						<h3>Interim Management: Transformation Leadership</h3>
						<div class="project-details">
							<span class="industry">HR Services</span>
							<span class="position">Interim CTO</span>
							<span class="duration">12 Months</span>
						</div>
					</div>
				</div>
				<div class="project-content">
					<div class="challenge">
						<h4>Challenge</h4>
						<p>Company needed strategic IT leadership during reorganization and digital transformation for 2,000-employee organization.</p>
					</div>
					<div class="results">
						<h4>Results:</h4>
						<ul class="results-list">
							<li>Successful preparation for ISO 27001 certification</li>
							<li>Security Operations Center integration with 24/7 monitoring</li>
							<li>Mobile device management for 2,000 endpoints</li>
							<li>Improved service delivery following ITIL V4 principles</li>
							<li>Strengthened IT organization for sustainable growth</li>
						</ul>
					</div>
				</div>
			</div>
			
			<div class="project-card">
				<div class="project-header">
					<div class="project-meta">
						<h3>Digital Transformation: Cloud-First Migration</h3>
						<div class="project-details">
							<span class="industry">HR Services</span>
							<span class="size">2,000 Employees</span>
							<span class="duration">18 Months</span>
						</div>
					</div>
				</div>
				<div class="project-content">
					<div class="challenge">
						<h4>Challenge</h4>
						<p>Legacy on-premise infrastructure, decentralized systems, high operational costs</p>
					</div>
					<div class="results">
						<h4>Results:</h4>
						<ul class="results-list">
							<li><strong>60% cost reduction</strong> in IT operations</li>
							<li>99.98% availability through geo-redundant datacenters</li>
							<li>Scalable infrastructure for global growth</li>
							<li>Modern workplaces with "Work from Anywhere" capability</li>
						</ul>
					</div>
				</div>
			</div>
			
			<div class="project-card">
				<div class="project-header">
					<div class="project-meta">
						<h3>Infrastructure Consolidation: 5-to-2 Datacenter Migration</h3>
						<div class="project-details">
							<span class="industry">HR Services</span>
							<span class="size">2,000 Employees</span>
							<span class="duration">18 Months</span>
						</div>
					</div>
				</div>
				<div class="project-content">
					<div class="challenge">
						<h4>Challenge</h4>
						<p>5 European server housing locations with performance and security issues</p>
					</div>
					<div class="results">
						<h4>Results:</h4>
						<ul class="results-list">
							<li><strong>40% cost savings</strong> with improved performance</li>
							<li>Simplified management and monitoring</li>
							<li>Enhanced security and compliance</li>
							<li>99.98% SLA standards implementation</li>
						</ul>
					</div>
				</div>
			</div>
			
			<div class="project-card">
				<div class="project-header">
					<div class="project-meta">
						<h3>Communication Modernization: VoIP Transformation</h3>
						<div class="project-details">
							<span class="industry">HR Services</span>
							<span class="scope">50 Locations</span>
							<span class="savings">82% Cost Savings</span>
						</div>
					</div>
				</div>
				<div class="project-content">
					<div class="challenge">
						<h4>Challenge</h4>
						<p>50 decentralized telephone systems, annual costs €259,740</p>
					</div>
					<div class="results">
						<h4>Results:</h4>
						<ul class="results-list">
							<li>Reduction of annual costs to <strong>€46,800 (82% savings)</strong></li>
							<li>Modern features and central management</li>
							<li>Crisis resilience through strategic timing</li>
							<li>Austria-wide unified phone number</li>
						</ul>
					</div>
				</div>
			</div>
			
			<div class="project-card">
				<div class="project-header">
					<div class="project-meta">
						<h3>Security Enhancement: SOC Implementation</h3>
						<div class="project-details">
							<span class="industry">HR Services</span>
							<span class="monitoring">24/7 Monitoring</span>
							<span class="duration">12 Months</span>
						</div>
					</div>
				</div>
				<div class="project-content">
					<div class="challenge">
						<h4>Challenge</h4>
						<p>Increased cyber threats, limited internal security resources</p>
					</div>
					<div class="results">
						<h4>Results:</h4>
						<ul class="results-list">
							<li>24/7/365 security monitoring implementation</li>
							<li>Significant reduction of false positives</li>
							<li>Relief of internal IT teams</li>
							<li>Enhanced compliance readiness</li>
						</ul>
					</div>
				</div>
			</div>
			
			<div class="project-card">
				<div class="project-header">
					<div class="project-meta">
						<h3>IT Service Management: ITSM Transformation</h3>
						<div class="project-details">
							<span class="industry">HR Services</span>
							<span class="framework">ITIL V4</span>
							<span class="duration">18 Months</span>
						</div>
					</div>
				</div>
				<div class="project-content">
					<div class="challenge">
						<h4>Challenge</h4>
						<p>Classic ticketing without CMDB or structured processes</p>
					</div>
					<div class="results">
						<h4>Results:</h4>
						<ul class="results-list">
							<li>Structured problem and change management</li>
							<li>Complete asset transparency via CMDB</li>
							<li>Improved service quality and speed</li>
							<li>ITIL V4 process implementation</li>
						</ul>
					</div>
				</div>
			</div>
		</div>
		
		<div class="technology-expertise">
			<h3>Technology Expertise</h3>
			<div class="tech-categories">
				<div class="tech-category">
					<h4>Cloud Platforms</h4>
					<div class="tech-tags">
						<span class="tech-tag">Microsoft Azure</span>
						<span class="tech-tag">AWS</span>
						<span class="tech-tag">Microsoft 365</span>
						<span class="tech-tag">Infrastructure-as-Code</span>
					</div>
				</div>
				<div class="tech-category">
					<h4>Infrastructure & Virtualization</h4>
					<div class="tech-tags">
						<span class="tech-tag">Hyper-V</span>
						<span class="tech-tag">Citrix</span>
						<span class="tech-tag">Active Directory</span>
						<span class="tech-tag">Network SDN</span>
					</div>
				</div>
				<div class="tech-category">
					<h4>Security & Compliance</h4>
					<div class="tech-tags">
						<span class="tech-tag">Zero Trust Architecture</span>
						<span class="tech-tag">ISO 27001</span>
						<span class="tech-tag">Endpoint Security</span>
						<span class="tech-tag">MDM</span>
					</div>
				</div>
				<div class="tech-category">
					<h4>Development & Automation</h4>
					<div class="tech-tags">
						<span class="tech-tag">DevOps</span>
						<span class="tech-tag">CI/CD Pipelines</span>
						<span class="tech-tag">Terraform</span>
						<span class="tech-tag">PowerShell</span>
					</div>
				</div>
			</div>
		</div>
	</div>
</section>

<style>
	.projects {
		background: var(--bg-secondary);
		padding: var(--spacing-xxl) 0;
	}
	
	.portfolio-markdown {
		margin-bottom: 40px;
		text-align: center;
	}
	
	.portfolio-markdown :global(h2),
	.portfolio-markdown :global(h3) {
		color: var(--text-primary);
		margin-bottom: 16px;
	}
	
	.portfolio-markdown :global(p) {
		color: var(--text-light);
		line-height: 1.6;
		margin-bottom: 16px;
	}
	
	.portfolio-intro {
		text-align: center;
		font-size: var(--font-size-lg);
		color: var(--text-light);
		max-width: 800px;
		margin: 0 auto var(--spacing-xxl);
		line-height: 1.6;
	}
	
	.projects-grid {
		display: grid;
		grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
		gap: 0.5rem;
		margin-bottom: var(--spacing-xxl);
	}
	
	.project-card {
		background: var(--bg-primary);
		border-radius: var(--radius-lg);
		padding: var(--spacing-xl);
		box-shadow: var(--shadow-md);
		transition: transform var(--transition-normal), box-shadow var(--transition-normal);
		border-left: 4px solid var(--primary-color);
	}
	
	
	.project-card:hover {
		transform: translateY(-5px);
		box-shadow: var(--shadow-lg);
	}
	
	.project-header {
		display: flex;
		align-items: flex-start;
		gap: var(--spacing-lg);
		margin-bottom: var(--spacing-xl);
	}
	
	.project-icon {
		font-size: 2.5rem;
		flex-shrink: 0;
	}
	
	.project-meta h3 {
		font-family: var(--font-headings);
		font-size: var(--font-size-lg);
		color: var(--text-dark);
		margin: 0 0 var(--spacing-xs) 0;
		font-weight: 600;
		line-height: 1.3;
	}
	
	.project-meta .project-subtitle {
		font-family: var(--font-headings);
		font-size: var(--font-size-base);
		font-weight: 400;
		color: var(--text-light);
		margin: 0 0 var(--spacing-sm) 0;
		line-height: 1.2;
	}
	
	.project-details {
		display: flex;
		flex-wrap: wrap;
		gap: var(--spacing-sm);
	}
	
	.project-details span {
		background: var(--bg-secondary);
		padding: 4px 12px;
		border-radius: var(--radius-sm);
		font-size: var(--font-size-sm);
		color: var(--text-light);
		font-weight: 500;
	}
	
	.project-content .challenge,
	.project-content .results {
		margin-bottom: var(--spacing-lg);
	}
	
	.project-content h4 {
		font-family: var(--font-headings);
		font-size: var(--font-size-base);
		color: var(--text-dark);
		margin: 0 0 var(--spacing-sm) 0;
		font-weight: 600;
		text-transform: uppercase;
		letter-spacing: 0.5px;
	}
	
	.project-content p {
		color: var(--text-light);
		line-height: 1.6;
		margin: 0;
	}
	
	.results-list {
		list-style: none;
		padding: 0;
		margin: 0;
	}
	
	.results-list li {
		position: relative;
		padding-left: var(--spacing-lg);
		margin-bottom: var(--spacing-sm);
		color: var(--text-light);
		line-height: 1.5;
	}
	
	.results-list li::before {
		content: "✓";
		position: absolute;
		left: 0;
		color: #28a745;
		font-weight: bold;
	}
	
	.results-list strong {
		color: var(--text-dark);
		font-weight: 600;
	}
	
	.technology-expertise {
		background: var(--bg-primary);
		padding: var(--spacing-xxl);
		border-radius: var(--radius-lg);
		box-shadow: var(--shadow-md);
	}
	
	.technology-expertise h3 {
		font-family: var(--font-headings);
		font-size: var(--font-size-2xl);
		color: var(--text-dark);
		text-align: center;
		margin: 0 0 var(--spacing-xl) 0;
		font-weight: 600;
	}
	
	.tech-categories {
		display: grid;
		grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
		gap: var(--spacing-xl);
	}
	
	.tech-category h4 {
		font-family: var(--font-headings);
		font-size: var(--font-size-lg);
		color: var(--text-dark);
		margin: 0 0 var(--spacing-md) 0;
		font-weight: 600;
	}
	
	.tech-tags {
		display: flex;
		flex-wrap: wrap;
		gap: var(--spacing-sm);
	}
	
	.tech-tag {
		background: var(--bg-gradient);
		color: var(--text-white);
		padding: 6px 14px;
		border-radius: var(--radius-md);
		font-size: var(--font-size-sm);
		font-weight: 500;
		transition: transform var(--transition-fast);
	}
	
	.tech-tag:hover {
		transform: scale(1.05);
	}
	
	@media (max-width: 768px) {
		.projects-grid {
			grid-template-columns: 1fr;
		}
		
		.project-header {
			flex-direction: column;
			text-align: center;
		}
		
		.tech-categories {
			grid-template-columns: 1fr;
		}
		
		.project-details {
			justify-content: center;
		}
	}
</style>