---
import { getUITranslations, getLangFromUrl, getPageContent } from '../utils/i18n.ts';

const { url } = Astro;
const lang = getLangFromUrl(url);
const ui = await getUITranslations(lang);
const servicesContent = await getPageContent(lang, 'services');

// Fallback content if markdown content is not available
const content = servicesContent ? await servicesContent.render() : null;

// Extract data to avoid complex expressions in template
const servicesData = ui.services || {};
const interimFeatures = servicesData.interimManagement?.features || [];
const interimBenefits = servicesData.interimManagement?.benefits || [];
const cloudFeatures = servicesData.cloudMigration?.features || [];
const cloudBenefits = servicesData.cloudMigration?.benefits || [];
const itFeatures = servicesData.itOperations?.features || [];
const itBenefits = servicesData.itOperations?.benefits || [];
const aiFeatures = servicesData.aiConsulting?.features || [];
const aiBenefits = servicesData.aiConsulting?.benefits || [];
const seoFeatures = servicesData.seoServices?.features || [];
const seoBenefits = servicesData.seoServices?.benefits || [];
---

<section id="services" class="services section">
	<div class="container">
		<h2 class="section-title">{ui.services.title}</h2>
		
		<div class="services-intro">
			<p class="intro-text">{ui.services.subtitle}</p>
		</div>
		
		{servicesContent && (
			<div class="services-markdown">
				<Fragment set:html={content?.Content} />
			</div>
		)}
		
		<div class="services-tabs">
			<div class="tab-navigation">
				<button class="tab-btn active" data-tab="interim-management">
					<div class="tab-icon">
						<img src="/icons/interim-management.svg" alt={ui.services.interimManagement.title} />
					</div>
					<span class="tab-title">{ui.services.interimManagement.title}</span>
				</button>
				
				<button class="tab-btn" data-tab="cloud-migration">
					<div class="tab-icon">
						<img src="/icons/cloud-migration.svg" alt={ui.services.cloudMigration.title} />
					</div>
					<span class="tab-title">{ui.services.cloudMigration.title}</span>
				</button>
				
				<button class="tab-btn" data-tab="it-operations">
					<div class="tab-icon">
						<img src="/icons/it-operations.svg" alt={ui.services.itOperations.title} />
					</div>
					<span class="tab-title">{ui.services.itOperations.title}</span>
				</button>
				
				<button class="tab-btn" data-tab="ai-consulting">
					<div class="tab-icon">
						<img src="/icons/ai-consulting.svg" alt={ui.services.aiConsulting.title} />
					</div>
					<span class="tab-title">{ui.services.aiConsulting.title}</span>
				</button>
				
				<button class="tab-btn" data-tab="seo-services">
					<div class="tab-icon">
						<img src="/icons/seo-services.svg" alt={ui.services.seoServices.title} />
					</div>
					<span class="tab-title">{ui.services.seoServices.title}</span>
				</button>
			</div>
			
			<div class="tab-content">
				<div class="tab-pane active" id="interim-management">
					<div class="service-content">
						<h3>{ui.services.interimManagement.title}</h3>
						<p class="service-description">{ui.services.interimManagement.description}</p>
						
						<div class="service-details">
							<div class="service-features">
								<h4>{ui.services.keyFeatures}</h4>
								<ul>
									{interimFeatures.map((feature: string) => (
										<li>{feature}</li>
									))}
								</ul>
							</div>
							
							<div class="service-benefits">
								<h4>{ui.services.benefits}</h4>
								<ul>
									{interimBenefits.map((benefit: string) => (
										<li>{benefit}</li>
									))}
								</ul>
							</div>
						</div>
						
						<div class="service-cta">
							<a href={`/${lang}/#contact`} class="btn btn-primary">{ui.services.ctaButton}</a>
						</div>
					</div>
				</div>
				
				<div class="tab-pane" id="cloud-migration">
					<div class="service-content">
						<h3>{ui.services.cloudMigration.title}</h3>
						<p class="service-description">{ui.services.cloudMigration.description}</p>
						
						<div class="service-details">
							<div class="service-features">
								<h4>{ui.services.keyFeatures}</h4>
								<ul>
									{cloudFeatures.map((feature: string) => (
										<li>{feature}</li>
									))}
								</ul>
							</div>
							
							<div class="service-benefits">
								<h4>{ui.services.benefits}</h4>
								<ul>
									{cloudBenefits.map((benefit: string) => (
										<li>{benefit}</li>
									))}
								</ul>
							</div>
						</div>
						
						<div class="service-cta">
							<a href={`/${lang}/#contact`} class="btn btn-primary">{ui.services.ctaButton}</a>
						</div>
					</div>
				</div>
				
				<div class="tab-pane" id="it-operations">
					<div class="service-content">
						<h3>{ui.services.itOperations.title}</h3>
						<p class="service-description">{ui.services.itOperations.description}</p>
						
						<div class="service-details">
							<div class="service-features">
								<h4>{ui.services.keyFeatures}</h4>
								<ul>
									{itFeatures.map((feature: string) => (
										<li>{feature}</li>
									))}
								</ul>
							</div>
							
							<div class="service-benefits">
								<h4>{ui.services.benefits}</h4>
								<ul>
									{itBenefits.map((benefit: string) => (
										<li>{benefit}</li>
									))}
								</ul>
							</div>
						</div>
						
						<div class="service-cta">
							<a href={`/${lang}/#contact`} class="btn btn-primary">{ui.services.ctaButton}</a>
						</div>
					</div>
				</div>
				
				<div class="tab-pane" id="ai-consulting">
					<div class="service-content">
						<h3>{ui.services.aiConsulting.title}</h3>
						<p class="service-description">{ui.services.aiConsulting.description}</p>
						
						<div class="service-details">
							<div class="service-features">
								<h4>{ui.services.keyFeatures}</h4>
								<ul>
									{aiFeatures.map((feature: string) => (
										<li>{feature}</li>
									))}
								</ul>
							</div>
							
							<div class="service-benefits">
								<h4>{ui.services.benefits}</h4>
								<ul>
									{aiBenefits.map((benefit: string) => (
										<li>{benefit}</li>
									))}
								</ul>
							</div>
						</div>
						
						<div class="service-cta">
							<a href={`/${lang}/#contact`} class="btn btn-primary">{ui.services.ctaButton}</a>
						</div>
					</div>
				</div>
				
				<div class="tab-pane" id="seo-services">
					<div class="service-content">
						<h3>{ui.services.seoServices.title}</h3>
						<p class="service-description">{ui.services.seoServices.description}</p>
						
						<div class="service-details">
							<div class="service-features">
								<h4>{ui.services.keyFeatures}</h4>
								<ul>
									{seoFeatures.map((feature: string) => (
										<li>{feature}</li>
									))}
								</ul>
							</div>
							
							<div class="service-benefits">
								<h4>{ui.services.benefits}</h4>
								<ul>
									{seoBenefits.map((benefit: string) => (
										<li>{benefit}</li>
									))}
								</ul>
							</div>
						</div>
						
						<div class="service-cta">
							<a href={`/${lang}/#contact`} class="btn btn-primary">{ui.services.ctaButton}</a>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</section>

<style>
	.services {
		background: #f8f9fa;
	}
	
	.services-intro {
		margin-bottom: 60px;
		text-align: center;
	}
	
	.intro-text {
		font-size: var(--font-size-lg);
		color: var(--text-light);
		max-width: 800px;
		margin: 0 auto;
		line-height: 1.6;
		font-weight: 100;
	}
	
	.services-markdown {
		margin-bottom: 40px;
		text-align: center;
	}
	
	.services-markdown :global(h2),
	.services-markdown :global(h3) {
		color: var(--text-primary);
		margin-bottom: 16px;
	}
	
	.services-markdown :global(p) {
		color: var(--text-light);
		line-height: 1.6;
		margin-bottom: 16px;
	}
	
	.service-content {
		padding: 40px;
		background: var(--bg-primary);
		border-radius: var(--radius-lg);
		box-shadow: var(--shadow-lg);
	}
	
	.service-content h3 {
		color: var(--text-primary);
		font-size: var(--font-size-2xl);
		margin-bottom: 20px;
		text-align: center;
	}
	
	.service-description {
		font-size: var(--font-size-lg);
		color: var(--text-dark);
		text-align: center;
		margin-bottom: 40px;
		line-height: 1.6;
		font-weight: 600;
	}
	
	.service-details {
		display: grid;
		grid-template-columns: 1fr 1fr;
		gap: 40px;
		margin-bottom: 40px;
	}
	
	.service-features h4,
	.service-benefits h4 {
		color: var(--text-primary);
		font-size: var(--font-size-xl);
		margin-bottom: 20px;
		text-align: center;
	}
	
	.service-features ul,
	.service-benefits ul {
		list-style: none;
		padding: 0;
	}
	
	.service-features li,
	.service-benefits li {
		padding: 10px 0;
		padding-left: 30px;
		position: relative;
		color: var(--text-light);
		line-height: 1.5;
	}
	
	.service-features li::before,
	.service-benefits li::before {
		content: "âœ“";
		position: absolute;
		left: 0;
		color: var(--primary);
		font-weight: bold;
		font-size: 16px;
	}
	
	.service-cta {
		text-align: center;
	}
	
	.service-cta .btn {
		font-size: var(--font-size-lg);
		padding: 16px 32px;
	}
	
	.problem-card {
		background: var(--bg-primary);
		padding: var(--spacing-xl) var(--spacing-xl);
		border-radius: var(--radius-lg);
		text-align: center;
		box-shadow: var(--shadow-lg);
		transition: transform var(--transition-normal), box-shadow var(--transition-normal);
		height: 100%;
	}
	
	.problem-card:hover {
		transform: translateY(-10px);
		box-shadow: var(--shadow-xl);
	}
	
	.problem-icon {
		font-size: var(--font-size-4xl);
		margin-bottom: var(--spacing-lg);
		height: 80px;
		display: flex;
		align-items: center;
		justify-content: center;
	}
	
	.problem-card h3 {
		font-size: var(--font-size-xl);
		color: var(--text-dark);
		margin-bottom: var(--spacing-lg);
		font-weight: 600;
	}
	
	.problem-card p {
		color: var(--text-light);
		line-height: 1.6;
		margin-bottom: var(--spacing-md);
	}
	
	.solution {
		color: var(--primary-color);
		font-weight: 600;
		font-style: italic;
	}
	
	.services-tabs {
		background: var(--bg-primary);
		border-radius: var(--radius-xl);
		overflow: hidden;
		box-shadow: var(--shadow-lg);
	}
	
	/* Mobile First: Horizontal scrolling tabs */
	.tab-navigation {
		background: #f8f9fa;
		display: flex;
		flex-direction: row;
		overflow-x: auto;
		scrollbar-width: none; /* Firefox */
		-ms-overflow-style: none; /* IE/Edge */
		border-bottom: 1px solid #e9ecef;
		padding: 0 var(--spacing-sm);
	}
	
	.tab-navigation::-webkit-scrollbar {
		display: none; /* Chrome/Safari */
	}
	
	.tab-btn {
		background: none;
		border: none;
		padding: var(--spacing-md) var(--spacing-lg);
		text-align: center;
		cursor: pointer;
		transition: all var(--transition-normal);
		border-bottom: 3px solid transparent;
		color: var(--text-light);
		font-weight: 500;
		display: flex;
		flex-direction: column;
		align-items: center;
		gap: var(--spacing-xs);
		min-width: 140px;
		flex-shrink: 0;
		white-space: nowrap;
		position: relative;
	}
	
	.tab-btn:hover {
		background: rgba(255, 255, 255, 0.5);
		color: var(--text-dark);
		border-bottom-color: var(--primary-color);
	}
	
	.tab-btn.active {
		background: rgba(255, 255, 255, 0.8);
		color: var(--text-dark);
		border-bottom-color: var(--primary-color);
	}
	
	.tab-btn.active-highlight {
		background: rgba(255, 255, 255, 0.8);
		color: var(--text-dark);
		border-bottom-color: #dc3545;
	}
	
	.tab-btn.active-highlight .tab-icon {
		color: #dc3545;
	}
	
	.tab-icon {
		width: 32px;
		height: 32px;
		display: flex;
		align-items: center;
		justify-content: center;
		flex-shrink: 0;
	}
	
	.tab-icon img {
		width: 100%;
		height: 100%;
		object-fit: contain;
	}
	
	.tab-title {
		font-size: 0.8rem;
		line-height: 1.2;
		text-align: center;
		max-width: 120px;
		white-space: normal;
	}
	
	.tab-content {
		padding: var(--spacing-xl) var(--spacing-lg);
		background: #ffffff;
	}
	
	/* Desktop: Vertical tabs */
	@media (min-width: 769px) {
		.services-tabs {
			display: grid;
			grid-template-columns: 350px 1fr;
			min-height: 500px;
		}
		
		.tab-navigation {
			flex-direction: column;
			overflow-x: visible;
			border-bottom: none;
			border-right: 1px solid #e9ecef;
			padding: 0;
		}
		
		.tab-btn {
			flex-direction: row;
			text-align: left;
			padding: var(--spacing-lg) var(--spacing-xl);
			gap: var(--spacing-lg);
			min-width: auto;
			min-height: 80px;
			border-bottom: none;
			border-left: 4px solid transparent;
			white-space: normal;
		}
		
		.tab-btn:hover {
			background: #ffffff;
			border-left-color: var(--primary-color);
			border-bottom-color: transparent;
		}
		
		.tab-btn.active {
			background: #ffffff;
			border-left-color: var(--primary-color);
			border-bottom-color: transparent;
			box-shadow: inset 4px 0 0 var(--primary-color);
		}
		
		.tab-btn.active-highlight {
			border-left-color: #dc3545;
			border-bottom-color: transparent;
			box-shadow: inset 4px 0 0 #dc3545;
		}
		
		.tab-icon {
			width: 40px;
			height: 40px;
		}
		
		.tab-title {
			font-size: 0.95rem;
			line-height: 1.4;
			flex: 1;
			text-align: left;
			max-width: none;
		}
		
		.tab-content {
			padding: var(--spacing-xxl);
		}
	}
	
	.tab-pane {
		display: none;
	}
	
	.tab-pane.active {
		display: block;
	}
	
	.service-features h3 {
		font-family: var(--font-headings);
		font-size: var(--font-size-xl);
		color: var(--text-dark);
		margin-bottom: var(--spacing-md);
		font-weight: 600;
	}
	
	.service-features > p {
		font-size: var(--font-size-base);
		color: var(--text-light);
		margin-bottom: var(--spacing-xl);
		line-height: 1.6;
	}
	
	.features-list {
		display: flex;
		flex-direction: column;
		gap: var(--spacing-md);
	}
	
	.feature-item {
		display: flex;
		align-items: flex-start;
		gap: var(--spacing-md);
		font-size: var(--font-size-base);
		color: var(--text-dark);
		line-height: 1.6;
	}
	
	.feature-icon {
		width: 20px;
		height: 20px;
		border: 2px solid #e9ecef;
		border-radius: 50%;
		display: flex;
		align-items: center;
		justify-content: center;
		flex-shrink: 0;
		margin-top: 2px;
		font-size: 12px;
		color: #6c757d;
	}
	
	/* Mobile optimizations */
	@media (max-width: 768px) {
		.service-details {
			grid-template-columns: 1fr;
			gap: 30px;
		}
		
		.service-content {
			padding: 30px 20px;
		}
		
		.service-content h3 {
			font-size: var(--font-size-xl);
			line-height: 1.3;
		}
		
		.service-description {
			font-size: var(--font-size-base);
		}
		
		.service-features h4,
		.service-benefits h4 {
			font-size: var(--font-size-lg);
		}
		
		.service-features li,
		.service-benefits li {
			font-size: var(--font-size-sm);
			padding: 8px 0;
			padding-left: 25px;
		}
		
		.service-features li::before,
		.service-benefits li::before {
			font-size: 14px;
		}
		
		.service-features h3 {
			font-size: var(--font-size-lg);
			line-height: 1.3;
		}
		
		.service-features > p {
			font-size: var(--font-size-sm);
		}
		
		.features-list {
			gap: var(--spacing-sm);
		}
		
		.feature-item {
			font-size: var(--font-size-sm);
		}
	}
</style>

<script>
	// Tab functionality
	const tabBtns = document.querySelectorAll('.tab-btn');
	const tabPanes = document.querySelectorAll('.tab-pane');
	
	tabBtns.forEach(btn => {
		btn.addEventListener('click', () => {
			const tabId = btn.getAttribute('data-tab');
			
			// Remove active class from all tabs and panes
			tabBtns.forEach(b => b.classList.remove('active'));
			tabPanes.forEach(p => p.classList.remove('active'));
			
			// Add active class to clicked tab and corresponding pane
			btn.classList.add(tabId === 'digital-marketing' ? 'active-highlight' : 'active');
			if (tabId) {
				const targetTab = document.getElementById(tabId);
				if (targetTab) {
					targetTab.classList.add('active');
				}
			}
		});
	});
</script>