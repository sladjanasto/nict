---
import { getUITranslations, getLangFromUrl, getPageContent } from '../utils/i18n.ts';

const { url } = Astro;
const lang = getLangFromUrl(url);
const ui = await getUITranslations(lang);
const servicesContent = await getPageContent(lang, 'services');

// Fallback content if markdown content is not available
const content = servicesContent ? await servicesContent.render() : null;

// Extract data to avoid complex expressions in template
const servicesData = ui.services || {};
const interimFeatures = servicesData.interimManagement?.features || [];
const interimBenefits = servicesData.interimManagement?.benefits || [];
const cloudFeatures = servicesData.cloudMigration?.features || [];
const cloudBenefits = servicesData.cloudMigration?.benefits || [];
const itFeatures = servicesData.itOperations?.features || [];
const itBenefits = servicesData.itOperations?.benefits || [];
const aiFeatures = servicesData.aiConsulting?.features || [];
const aiBenefits = servicesData.aiConsulting?.benefits || [];
const seoFeatures = servicesData.seoServices?.features || [];
const seoBenefits = servicesData.seoServices?.benefits || [];
---

<section id="services" class="services section">
	<div class="services-container">
		<h2 class="section-title">{ui.services.title}</h2>
		
		<div class="services-intro">
			<p class="intro-text">{ui.services.subtitle}</p>
		</div>
		
		{servicesContent && (
			<div class="services-markdown">
				<Fragment set:html={content?.Content} />
			</div>
		)}
		
		<div class="services-grid">
			<!-- Service Card 1: Interim Management -->
			<div class="service-card">
				<div class="service-header">
					<h3>{ui.services.interimManagement.title}</h3>
					<p class="service-description">{ui.services.interimManagement.description}</p>
				</div>
				
				<div class="service-details">
					<div class="service-features">
						<h4>{ui.services.keyFeatures}</h4>
						<ul>
							{interimFeatures.map((feature: string) => (
								<li>{feature}</li>
							))}
						</ul>
					</div>
					
					<div class="service-benefits">
						<h4>{ui.services.benefits}</h4>
						<ul>
							{interimBenefits.map((benefit: string) => (
								<li>{benefit}</li>
							))}
						</ul>
					</div>
				</div>
				
				<div class="service-cta">
					<a href={`/${lang}/#contact`} class="btn btn-primary">{ui.services.ctaButton}</a>
				</div>
			</div>
			
			<!-- Service Card 2: Cloud Migration -->
			<div class="service-card">
				<div class="service-header">
					<h3>{ui.services.cloudMigration.title}</h3>
					<p class="service-description">{ui.services.cloudMigration.description}</p>
				</div>
				
				<div class="service-details">
					<div class="service-features">
						<h4>{ui.services.keyFeatures}</h4>
						<ul>
							{cloudFeatures.map((feature: string) => (
								<li>{feature}</li>
							))}
						</ul>
					</div>
					
					<div class="service-benefits">
						<h4>{ui.services.benefits}</h4>
						<ul>
							{cloudBenefits.map((benefit: string) => (
								<li>{benefit}</li>
							))}
						</ul>
					</div>
				</div>
				
				<div class="service-cta">
					<a href={`/${lang}/#contact`} class="btn btn-primary">{ui.services.ctaButton}</a>
				</div>
			</div>
			
			<!-- Service Card 3: IT Operations -->
			<div class="service-card">
				<div class="service-header">
					<h3>{ui.services.itOperations.title}</h3>
					<p class="service-description">{ui.services.itOperations.description}</p>
				</div>
				
				<div class="service-details">
					<div class="service-features">
						<h4>{ui.services.keyFeatures}</h4>
						<ul>
							{itFeatures.map((feature: string) => (
								<li>{feature}</li>
							))}
						</ul>
					</div>
					
					<div class="service-benefits">
						<h4>{ui.services.benefits}</h4>
						<ul>
							{itBenefits.map((benefit: string) => (
								<li>{benefit}</li>
							))}
						</ul>
					</div>
				</div>
				
				<div class="service-cta">
					<a href={`/${lang}/#contact`} class="btn btn-primary">{ui.services.ctaButton}</a>
				</div>
			</div>
			
			<!-- Service Card 4: AI Consulting -->
			<div class="service-card">
				<div class="service-header">
					<h3>{ui.services.aiConsulting.title}</h3>
					<p class="service-description">{ui.services.aiConsulting.description}</p>
				</div>
				
				<div class="service-details">
					<div class="service-features">
						<h4>{ui.services.keyFeatures}</h4>
						<ul>
							{aiFeatures.map((feature: string) => (
								<li>{feature}</li>
							))}
						</ul>
					</div>
					
					<div class="service-benefits">
						<h4>{ui.services.benefits}</h4>
						<ul>
							{aiBenefits.map((benefit: string) => (
								<li>{benefit}</li>
							))}
						</ul>
					</div>
				</div>
				
				<div class="service-cta">
					<a href={`/${lang}/#contact`} class="btn btn-primary">{ui.services.ctaButton}</a>
				</div>
			</div>
			
			<!-- Service Card 5: SEO Services -->
			<div class="service-card">
				<div class="service-header">
					<h3>{ui.services.seoServices.title}</h3>
					<p class="service-description">{ui.services.seoServices.description}</p>
				</div>
				
				<div class="service-details">
					<div class="service-features">
						<h4>{ui.services.keyFeatures}</h4>
						<ul>
							{seoFeatures.map((feature: string) => (
								<li>{feature}</li>
							))}
						</ul>
					</div>
					
					<div class="service-benefits">
						<h4>{ui.services.benefits}</h4>
						<ul>
							{seoBenefits.map((benefit: string) => (
								<li>{benefit}</li>
							))}
						</ul>
					</div>
				</div>
				
				<div class="service-cta">
					<button class="btn-link" id="seoPackagesToggle">
						<span class="toggle-text-show">{ui.services.explorePackages}</span>
						<span class="toggle-text-hide" style="display: none;">{ui.services.hideExplorePackages}</span>
						<i class="icon icon-arrow-down"></i>
					</button>
				</div>
			</div>
		</div>

	</div>
</section>

<style>
	.services {
		background: var(--bg-secondary);
	}
	
	.services-container {
		width: 100%;
		padding: 0;
	}
	
	.services-intro {
		margin-bottom: 60px;
		text-align: center;
	}
	
	.intro-text {
		font-size: var(--font-size-lg);
		color: var(--text-light);
		max-width: 800px;
		margin: 0 auto;
		line-height: 1.6;
	}
	
	.services-markdown {
		margin-bottom: 40px;
		text-align: center;
	}
	
	.services-markdown :global(h2),
	.services-markdown :global(h3) {
		color: var(--text-primary);
		margin-bottom: 16px;
	}
	
	.services-markdown :global(p) {
		color: var(--text-light);
		line-height: 1.6;
		margin-bottom: 16px;
	}
	
	.service-details {
		/* margin-bottom: 25px; */
		flex-grow: 1;
		display: flex;
		gap: var(--gap);
	}
	
	.service-features,
	.service-benefits {
		margin-bottom: 20px;
	}

	.service-features h4,
	.service-benefits h4 {
		color: var(--text-primary);
		font-size: var(--font-size-md);
		margin-bottom: 12px;
		font-weight: 600;

		padding-bottom: 8px;
		text-align: center;
	}
	
	.service-features ul,
	.service-benefits ul {
		list-style: none;
		padding: 0;
		margin: 0;
	}
	
	.service-features li,
	.service-benefits li {
		padding: 6px 0;
		padding-left: 20px;
		position: relative;
		color: var(--text-light);
		line-height: 1.4;
		font-size: var(--font-size-sm);
	}
	
	.service-features li::before,
	.service-benefits li::before {
		content: "âœ“";
		position: absolute;
		left: 0;
		color: var(--success-color);
		font-weight: bold;
		font-size: 14px;
	}
	
	.service-cta {
		text-align: center;
		margin-top: auto;
		/* padding-top: 20px; */
	}
	
	.service-cta .btn:not(.btn-link) {
		font-size: var(--font-size-sm);
		padding: 12px 24px;
		width: 100%;
	}
	
	.services-grid {
		display: grid;
		grid-template-columns: repeat(5, 1fr);
		width: 100%;
		box-sizing: border-box;
		padding: 0 2rem 0.1rem;
		
	}

	/* Service Cards */
	.service-card {
		background: var(--bg-primary);
		padding: 25px;
		display: flex;
		flex-direction: column;
		height: 100%;
		min-height: 400px;
		box-sizing: border-box;
		transition: all 0.3s ease;
	}

	/* Alternating background colors for cards */
	.service-card:nth-child(even) {
		background: var(--bg-secondary);
	}

	.service-card:nth-child(odd) {
		background: var(--bg-primary);
	}

	/* .service-card:hover {
		transform: translateY(-2px);
		box-shadow: var(--shadow-lg);
	} */

	.service-header {
		text-align: center;
		margin-bottom: 25px;
	}
	/* Responsive Design */
	@media (max-width: 1400px) {
		.services-grid {
			grid-template-columns: repeat(4, 1fr);
			gap: 18px;
		}
	}

	@media (max-width: 1200px) {
		.services-grid {
			grid-template-columns: repeat(3, 1fr);
			gap: 20px;
		}
	}

	@media (max-width: 900px) {
		.services-grid {
			grid-template-columns: repeat(2, 1fr);
			gap: 20px;
		}
		
		.service-card {
			padding: 20px;
			min-height: 350px;
		}
	}

	@media (max-width: 768px) {
		.services-grid {
			grid-template-columns: 1fr;
			gap: 0px;
			padding:0;
		}
		
		.service-card {
			padding: 20px;
			min-height: 300px;
		}
	}

	.service-card h3 {
		color: var(--primary-color);
		font-size: var(--font-size-xl);
		margin-bottom: 15px;
		font-weight: 600;
		line-height: 1.3;
		text-transform: uppercase;
	}

	.service-description {
		color: var(--text-light);
		font-size: var(--font-size-md);
		line-height: 1.5;
		margin-bottom: 0;
	}

		
		.service-card {
			padding: 25px 20px;
		}
		
		.service-card h3 {
			font-size: var(--font-size-lg);
		}
		
		.service-description {
			font-size: var(--font-size-sm);
		}
	}
	
	.packages-toggle {
		text-align: center;
		margin-top: var(--spacing-3xl);
		padding-top: var(--spacing-xl);
		border-top: 1px solid var(--border-light);
	}
	
	.packages-toggle .btn:not(.btn-link),
	.packages-toggle-btn:not(.btn-link) {
		background: var(--bg-gradient);
		color: white;
		border: none;
		font-weight: 600;
		transition: all var(--transition-normal);
		width: 100%;
	}
	
	.packages-toggle .btn:not(.btn-link):hover,
	.packages-toggle-btn:not(.btn-link):hover {
		transform: translateY(-2px);
		box-shadow: var(--shadow-lg);
	}
</style>

<script>
	document.addEventListener('DOMContentLoaded', function() {
		const seoPackagesToggle = document.getElementById('seoPackagesToggle');
		const packagesSection = document.getElementById('packagesSection');
		const toggleTextShow = seoPackagesToggle?.querySelector('.toggle-text-show') as HTMLElement;
		const toggleTextHide = seoPackagesToggle?.querySelector('.toggle-text-hide') as HTMLElement;
		
		if (!seoPackagesToggle || !packagesSection || !toggleTextShow || !toggleTextHide) return;
		
		let isVisible = false;
		
		seoPackagesToggle.addEventListener('click', function() {
			isVisible = !isVisible;
			
			if (isVisible) {
				packagesSection.classList.remove('packages-hidden');
				packagesSection.classList.add('packages-visible');
				toggleTextShow.style.display = 'none';
				toggleTextHide.style.display = 'inline';
				seoPackagesToggle.classList.add('expanded');
				
				// Smooth scroll to packages section
				setTimeout(() => {
					packagesSection.scrollIntoView({ 
						behavior: 'smooth', 
						block: 'start' 
					});
				}, 300);
			} else {
				packagesSection.classList.remove('packages-visible');
				packagesSection.classList.add('packages-hidden');
				toggleTextShow.style.display = 'inline';
				toggleTextHide.style.display = 'none';
				seoPackagesToggle.classList.remove('expanded');
				
				// Scroll back to services section
				const servicesSection = document.getElementById('services');
				if (servicesSection) {
					servicesSection.scrollIntoView({ 
						behavior: 'smooth', 
						block: 'center' 
					});
				}
			}
		});
	});
</script>

