---
import { getUITranslations, getLangFromUrl, getPageContent } from '../utils/i18n.ts';

const { url } = Astro;
const lang = getLangFromUrl(url);
const ui = await getUITranslations(lang);
const servicesContent = await getPageContent(lang, 'services');

// Fallback content if markdown content is not available
const content = servicesContent ? await servicesContent.render() : null;

// Extract data to avoid complex expressions in template
const servicesData = ui.services || {};
const interimFeatures = servicesData.interimManagement?.features || [];
const interimBenefits = servicesData.interimManagement?.benefits || [];
const cloudFeatures = servicesData.cloudMigration?.features || [];
const cloudBenefits = servicesData.cloudMigration?.benefits || [];
const itFeatures = servicesData.itOperations?.features || [];
const itBenefits = servicesData.itOperations?.benefits || [];
const aiFeatures = servicesData.aiConsulting?.features || [];
const aiBenefits = servicesData.aiConsulting?.benefits || [];
const seoFeatures = servicesData.seoServices?.features || [];
const seoBenefits = servicesData.seoServices?.benefits || [];
---

<section id="services" class="services section">
	<div class="container">
		<h2 class="section-title">{ui.services.title}</h2>
		
		<div class="services-intro">
			<p class="intro-text">{ui.services.subtitle}</p>
		</div>
		
		{servicesContent && (
			<div class="services-markdown">
				<Fragment set:html={content?.Content} />
			</div>
		)}
		
		<div class="services-grid">
			<!-- Interim Management Card -->
			<div class="service-card">
				<div class="service-header">
					<div class="service-icon">
						<img src="/icons/interim-management.svg" alt={ui.services.interimManagement.title} />
					</div>
					<h3>{ui.services.interimManagement.title}</h3>
					<p class="service-description">{ui.services.interimManagement.description}</p>
				</div>
				
				<div class="service-details">
					<div class="service-features">
						<h4>{ui.services.keyFeatures}</h4>
						<ul>
							{interimFeatures.map((feature: string) => (
								<li>{feature}</li>
							))}
						</ul>
					</div>
					
					<div class="service-benefits">
						<h4>{ui.services.benefits}</h4>
						<ul>
							{interimBenefits.map((benefit: string) => (
								<li>{benefit}</li>
							))}
						</ul>
					</div>
				</div>
				
				<div class="service-cta">
					<a href={`/${lang}/#contact`} class="btn btn-primary">{ui.services.ctaButton}</a>
				</div>
			</div>
			
			<!-- Cloud Migration Card -->
			<div class="service-card">
				<div class="service-header">
					<div class="service-icon">
						<img src="/icons/cloud-migration.svg" alt={ui.services.cloudMigration.title} />
					</div>
					<h3>{ui.services.cloudMigration.title}</h3>
					<p class="service-description">{ui.services.cloudMigration.description}</p>
				</div>
				
				<div class="service-details">
					<div class="service-features">
						<h4>{ui.services.keyFeatures}</h4>
						<ul>
							{cloudFeatures.map((feature: string) => (
								<li>{feature}</li>
							))}
						</ul>
					</div>
					
					<div class="service-benefits">
						<h4>{ui.services.benefits}</h4>
						<ul>
							{cloudBenefits.map((benefit: string) => (
								<li>{benefit}</li>
							))}
						</ul>
					</div>
				</div>
				
				<div class="service-cta">
					<a href={`/${lang}/#contact`} class="btn btn-primary">{ui.services.ctaButton}</a>
				</div>
			</div>
			
			<!-- IT Operations Card -->
			<div class="service-card">
				<div class="service-header">
					<div class="service-icon">
						<img src="/icons/it-operations.svg" alt={ui.services.itOperations.title} />
					</div>
					<h3>{ui.services.itOperations.title}</h3>
					<p class="service-description">{ui.services.itOperations.description}</p>
				</div>
				
				<div class="service-details">
					<div class="service-features">
						<h4>{ui.services.keyFeatures}</h4>
						<ul>
							{itFeatures.map((feature: string) => (
								<li>{feature}</li>
							))}
						</ul>
					</div>
					
					<div class="service-benefits">
						<h4>{ui.services.benefits}</h4>
						<ul>
							{itBenefits.map((benefit: string) => (
								<li>{benefit}</li>
							))}
						</ul>
					</div>
				</div>
				
				<div class="service-cta">
					<a href={`/${lang}/#contact`} class="btn btn-primary">{ui.services.ctaButton}</a>
				</div>
			</div>
			
			<!-- AI Consulting Card -->
			<div class="service-card">
				<div class="service-header">
					<div class="service-icon">
						<img src="/icons/ai-consulting.svg" alt={ui.services.aiConsulting.title} />
					</div>
					<h3>{ui.services.aiConsulting.title}</h3>
					<p class="service-description">{ui.services.aiConsulting.description}</p>
				</div>
				
				<div class="service-details">
					<div class="service-features">
						<h4>{ui.services.keyFeatures}</h4>
						<ul>
							{aiFeatures.map((feature: string) => (
								<li>{feature}</li>
							))}
						</ul>
					</div>
					
					<div class="service-benefits">
						<h4>{ui.services.benefits}</h4>
						<ul>
							{aiBenefits.map((benefit: string) => (
								<li>{benefit}</li>
							))}
						</ul>
					</div>
				</div>
				
				<div class="service-cta">
					<a href={`/${lang}/#contact`} class="btn btn-primary">{ui.services.ctaButton}</a>
				</div>
			</div>
			
			<!-- SEO Services Card -->
			<div class="service-card">
				<div class="service-header">
					<div class="service-icon">
						<img src="/icons/seo-services.svg" alt={ui.services.seoServices.title} />
					</div>
					<h3>{ui.services.seoServices.title}</h3>
					<p class="service-description">{ui.services.seoServices.description}</p>
				</div>
				
				<div class="service-details">
					<div class="service-features">
						<h4>{ui.services.keyFeatures}</h4>
						<ul>
							{seoFeatures.map((feature: string) => (
								<li>{feature}</li>
							))}
						</ul>
					</div>
					
					<div class="service-benefits">
						<h4>{ui.services.benefits}</h4>
						<ul>
							{seoBenefits.map((benefit: string) => (
								<li>{benefit}</li>
							))}
						</ul>
					</div>
				</div>
				
				<div class="service-cta">
					<button class="btn btn-secondary packages-toggle-btn" id="seoPackagesToggle">
						<span class="toggle-text-show">{ui.services.explorePackages}</span>
						<span class="toggle-text-hide" style="display: none;">{ui.services.hideExplorePackages}</span>
					</button>
				</div>
			</div>
		</div>
		

	</div>
</section>

<style>
	.services {
		background: #f8f9fa;
	}
	
	.services-intro {
		margin-bottom: 60px;
		text-align: center;
	}
	
	.intro-text {
		font-size: var(--font-size-lg);
		color: var(--text-light);
		max-width: 800px;
		margin: 0 auto;
		line-height: 1.6;
	}
	
	.services-markdown {
		margin-bottom: 40px;
		text-align: center;
	}
	
	.services-markdown :global(h2),
	.services-markdown :global(h3) {
		color: var(--text-primary);
		margin-bottom: 16px;
	}
	
	.services-markdown :global(p) {
		color: var(--text-light);
		line-height: 1.6;
		margin-bottom: 16px;
	}
	
	.service-details {
		/* margin-bottom: 25px; */
		flex-grow: 1;
	}
	
	.service-features,
	.service-benefits {
		margin-bottom: 20px;
	}

	.service-features h4,
	.service-benefits h4 {
		color: var(--text-primary);
		font-size: var(--font-size-md);
		margin-bottom: 12px;
		font-weight: 600;
		border-bottom: 2px solid var(--primary);
		padding-bottom: 8px;
		text-align: center;
	}
	
	.service-features ul,
	.service-benefits ul {
		list-style: none;
		padding: 0;
		margin: 0;
	}
	
	.service-features li,
	.service-benefits li {
		padding: 6px 0;
		padding-left: 20px;
		position: relative;
		color: var(--text-light);
		line-height: 1.4;
		font-size: var(--font-size-sm);
	}
	
	.service-features li::before,
	.service-benefits li::before {
		content: "âœ“";
		position: absolute;
		left: 0;
		color: #22c55e;
		font-weight: bold;
		font-size: 14px;
	}
	
	.service-cta {
		text-align: center;
		margin-top: auto;
		/* padding-top: 20px; */
	}
	
	.service-cta .btn {
		font-size: var(--font-size-sm);
		padding: 12px 24px;
		width: 100%;
	}
	
	.services-grid {
		display: grid;
		grid-template-columns: repeat(5, 1fr);
		gap: 30px;
		max-width: 1400px;
		margin: 0 auto;
	}

	.service-card {
		background: white;
		border-radius: 12px;
		padding: 30px;
		box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
		transition: all 0.3s ease;
		border: 1px solid rgba(0, 0, 0, 0.06);
		display: flex;
		flex-direction: column;
		height: 100%;
	}

	.service-card:hover {
		transform: translateY(-5px);
		box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
	}

	.service-header {
		text-align: center;
		margin-bottom: 25px;
	}
	.service-icon {
		width: 60px;
		height: 60px;
		margin: 0 auto 20px auto;
		display: flex;
		align-items: center;
		justify-content: center;
		background: var(--primary);
		border-radius: 50%;
		padding: 15px;
	}

	.service-icon img {
		width: 30px;
		height: 30px;
		filter: brightness(0) invert(1);
	}

	.service-card h3 {
		color: var(--primary-color);
		font-size: var(--font-size-xl);
		margin-bottom: 15px;
		font-weight: 600;
		line-height: 1.3;
		text-transform: uppercase;
	}

	.service-description {
		color: var(--text-light);
		font-size: var(--font-size-md);
		line-height: 1.5;
		margin-bottom: 0;
	}
	
	/* Responsive Design for Cards */
	@media (max-width: 1400px) {
		.services-grid {
			grid-template-columns: repeat(4, 1fr);
			gap: 25px;
		}
	}

	@media (max-width: 1200px) {
		.services-grid {
			grid-template-columns: repeat(3, 1fr);
			gap: 25px;
		}
	}

	@media (max-width: 900px) {
		.services-grid {
			grid-template-columns: repeat(2, 1fr);
			gap: 20px;
		}
		
		.service-card {
			padding: 25px;
		}
		
		.service-icon {
			width: 50px;
			height: 50px;
			margin-bottom: 15px;
			padding: 12px;
		}
		
		.service-icon img {
			width: 26px;
			height: 26px;
		}
	}

	@media (max-width: 768px) {
		.services {
			padding: 60px 0;
		}
		
		.services-grid {
			grid-template-columns: 1fr;
			gap: 20px;
			padding: 0 20px;
			max-width: 500px;
		}
		
		.service-card {
			padding: 25px 20px;
		}
		
		.service-card h3 {
			font-size: var(--font-size-lg);
		}
		
		.service-description {
			font-size: var(--font-size-sm);
		}
	}
	
	/* Mobile optimizations */
	@media (max-width: 768px) {
		.service-details {
			margin-bottom: 20px;
		}
		
		.service-features h4,
		.service-benefits h4 {
			font-size: var(--font-size-sm);
			margin-bottom: 10px;
		}
		
		.service-features li,
		.service-benefits li {
			font-size: 13px;
			padding: 4px 0;
			padding-left: 18px;
		}
		
		.service-features li::before,
		.service-benefits li::before {
			font-size: 12px;
			color: #22c55e;
		}
		
		.service-cta .btn {
			font-size: 13px;
			padding: 10px 20px;
		}
	}
	
	.packages-toggle {
		text-align: center;
		margin-top: var(--spacing-3xl);
		padding-top: var(--spacing-xl);
		border-top: 1px solid var(--border-light);
	}
	
	.packages-toggle .btn,
	.packages-toggle-btn {
		background: var(--bg-gradient);
		color: white;
		border: none;
		font-weight: 600;
		transition: all var(--transition-normal);
		width: 100%;
	}
	
	.packages-toggle .btn:hover,
	.packages-toggle-btn:hover {
		transform: translateY(-2px);
		box-shadow: var(--shadow-lg);
	}
</style>

<script>
	document.addEventListener('DOMContentLoaded', function() {
		const seoPackagesToggle = document.getElementById('seoPackagesToggle');
		const packagesSection = document.getElementById('packagesSection');
		const toggleTextShow = seoPackagesToggle?.querySelector('.toggle-text-show') as HTMLElement;
		const toggleTextHide = seoPackagesToggle?.querySelector('.toggle-text-hide') as HTMLElement;
		
		if (!seoPackagesToggle || !packagesSection || !toggleTextShow || !toggleTextHide) return;
		
		let isVisible = false;
		
		seoPackagesToggle.addEventListener('click', function() {
			isVisible = !isVisible;
			
			if (isVisible) {
				packagesSection.classList.remove('packages-hidden');
				packagesSection.classList.add('packages-visible');
				toggleTextShow.style.display = 'none';
				toggleTextHide.style.display = 'inline';
				
				// Smooth scroll to packages section
				setTimeout(() => {
					packagesSection.scrollIntoView({ 
						behavior: 'smooth', 
						block: 'start' 
					});
				}, 300);
			} else {
				packagesSection.classList.remove('packages-visible');
				packagesSection.classList.add('packages-hidden');
				toggleTextShow.style.display = 'inline';
				toggleTextHide.style.display = 'none';
				
				// Scroll back to services section
				const servicesSection = document.getElementById('services');
				if (servicesSection) {
					servicesSection.scrollIntoView({ 
						behavior: 'smooth', 
						block: 'center' 
					});
				}
			}
		});
	});
</script>

